# Stack up to 3 stacks on self
new entry "DT_AbnormalObstinacy"
type "PassiveData"
data "DisplayName" "h18a7c55cg4234g4716g8856g1b1215f646fc;1"
data "Description" "he64b0949g051bg4e54ga122g5a6981054955;1"
data "Icon" "PassiveFeature_ImprovedCritical"
data "Properties" "OncePerAttack;Highlighted"
data "StatsFunctorContext" "OnAttack"
data "Conditions" "IsHit() and Enemy() and IsMeleeWeaponAttack()"
data "StatsFunctors" "IF(DT_AbnormalObstinacyWeaponCondition(context.Source) and ConditionResult(GetStatusDuration('DT_AbnormalObstinacy_BOOST', context.Source) < 3)):ApplyStatus(SELF, DT_AbnormalObstinacy_BOOST, 100, 1);"

# For each stack up to 3 reduce critical threshold by 1
new entry "DT_AbnormalObstinacy_BOOST"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h18a7c55cg4234g4716g8856g1b1215f646fc;1"
data "Description" "he64b0949g051bg4e54ga122g5a6981054955;1"
data "Icon" "Status_Hag_HagEyed"
data "StackId" "DT_AbnormalObstinacy_BOOST"
data "RemoveEvents" "OnTurn"
data "StackType" "Additive"
data "StatusPropertyFlags" "MultiplyEffectsByDuration"
data "Boosts" "IF(AttackingWithMeleeWeapon(context.Source) and ConditionResult(GetStatusDuration('DT_AbnormalObstinacy_BOOST', context.Source) == 1)):ReduceCriticalAttackThreshold(1);IF(AttackingWithMeleeWeapon(context.Source) and ConditionResult(GetStatusDuration('DT_AbnormalObstinacy_BOOST', context.Source) == 2)):ReduceCriticalAttackThreshold(2);IF(AttackingWithMeleeWeapon(context.Source) and ConditionResult(GetStatusDuration('DT_AbnormalObstinacy_BOOST', context.Source) >= 3)):ReduceCriticalAttackThreshold(3)"
